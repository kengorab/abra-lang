enum Color {
  Red
  Green
  Blue
  RGB(r: Int, g: Int, b: Int)
  RGB2(r: Int = 0, g: Int = 0, b: Int = 0)

  func hex(self): String {
    if self == Color.Red {
      "0xFF0000"
    } else if self == Color.Green {
      "0x00FF00"
    } else if self == Color.Blue {
      "0x0000FF"
    } else {
      "todo"
    }
  }
}

val r = Color.Red
val g = Color.Green
val b = Color.Blue
val gray = Color.RGB(r: 0xaa, g: 0xaa, b: 0xaa)

// Testing enum variants with default values
val black = Color.RGB2()
val white = Color.RGB2(r: 255, g: 255, b: 255)
val red = Color.RGB2(r: 255)
val green = Color.RGB2(g: 255)
val blue = Color.RGB2(b: 255)
val pink = Color.RGB2(r: 255, b: 255)
val cyan = Color.RGB2(g: 255, b: 255)
val yellow = Color.RGB2(r: 255, g: 255)

/// Expect: Color.RGB2(r: 0, g: 0, b: 0)
printlnv2(black)
/// Expect: Color.RGB2(r: 255, g: 255, b: 255)
printlnv2(white)
/// Expect: Color.RGB2(r: 255, g: 0, b: 0)
printlnv2(red)
/// Expect: Color.RGB2(r: 0, g: 255, b: 0)
printlnv2(green)
/// Expect: Color.RGB2(r: 0, g: 0, b: 255)
printlnv2(blue)
/// Expect: Color.RGB2(r: 255, g: 0, b: 255)
printlnv2(pink)
/// Expect: Color.RGB2(r: 0, g: 255, b: 255)
printlnv2(cyan)
/// Expect: Color.RGB2(r: 255, g: 255, b: 0)
printlnv2(yellow)

// Test default toString method
/// Expect: Color.Red
printlnv2(r)
/// Expect: Color.Red
printlnv2(Color.Red)
/// Expect: Color.Green
printlnv2(g)
/// Expect: Color.Green
printlnv2(Color.Green)
/// Expect: Color.Blue
printlnv2(b)
/// Expect: Color.Blue
printlnv2(Color.Blue)
/// Expect: Color.RGB(r: 170, g: 170, b: 170)
printlnv2(gray)
/// Expect: Color.RGB(r: 170, g: 170, b: 170)
printlnv2(Color.RGB(r: 0xaa, g: 0xaa, b: 0xaa))

// Test default hash method
/// Expect: true
printlnv2(r.hash() == Color.Red.hash())
/// Expect: true
printlnv2(g.hash() == Color.Green.hash())
/// Expect: true
printlnv2(b.hash() == Color.Blue.hash())
/// Expect: true
printlnv2(gray.hash() == Color.RGB(r: 0xaa, g: 0xaa, b: 0xaa).hash())
/// Expect: false
printlnv2(r.hash() == Color.Blue.hash())
/// Expect: false
printlnv2(r.hash() == Color.Green.hash())
/// Expect: false
printlnv2(gray.hash() == Color.Red.hash())

// Test default eq method
/// Expect: true
printlnv2(r == Color.Red)
/// Expect: false
printlnv2(r == Color.Green)
/// Expect: false
printlnv2(r == Color.Blue)
/// Expect: true
printlnv2(gray == Color.RGB(r: 0xaa, g: 0xaa, b: 0xaa))
/// Expect: false
printlnv2(gray == Color.RGB(r: 0x33, g: 0x33, b: 0x33))
/// Expect: false
printlnv2(gray == Color.Green)

// Test calling method
/// Expect: 0xFF0000 0xFF0000
printlnv2("${Color.Red.hex()} ${r.hex()}")
/// Expect: 0x00FF00 0x00FF00
printlnv2("${Color.Green.hex()} ${g.hex()}")
/// Expect: 0x0000FF 0x0000FF
printlnv2("${Color.Blue.hex()} ${b.hex()}")
/// Expect: todo todo
printlnv2("${Color.RGB(r: 0xaa, g: 0xaa, b: 0xaa).hex()} ${gray.hex()}")

enum Color2 {
  Red
  Green
  Blue

  func toString(self): String = "custom Color2#toString implementation"
  func hash(self): Int = 17
  func eq(self, other: Color2): Bool {
    printlnv2("[Color2#eq] here")
    false
  }
}

// Test custom toString method
/// Expect: custom Color2#toString implementation
printlnv2(Color2.Red.toString())

// Test custom hash method
/// Expect: 17
printlnv2(Color2.Green.hash())

// Test custom eq method
/// Expect: [Color2#eq] here
/// Expect: false
printlnv2(Color2.Blue == Color2.Blue)

// Test generic enum

enum List<T> {
  Cons(value: T, next: List<T>)
  Nil

  // Silly static method
  func lengthOf<T>(list: List<T>): Int {
    list.length()
  }

  func length(self): Int {
    var length = 0
    var node = self
    while true {
      match node {
        List.Cons(_, next) => {
          length += 1
          node = next
        }
        List.Nil => break
      }
    }

    length
  }
}

val list = List.Cons(value: "a", next: List.Cons(value: "b", next: List.Cons(value: "c", next: List.Nil)))
/// Expect: 3
printlnv2(list.length())
/// Expect: 3
printlnv2(List.lengthOf(list))
